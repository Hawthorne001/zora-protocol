# Profile Queries

The Coins SDK provides several query functions to retrieve information about user profiles and their coin holdings. This page details the available profile query functions, their parameters, and includes usage examples.

Queries:

- [`getProfile`](#getprofile)
- [`getProfileBalances`](#getprofilebalances)

## Available Queries

### getProfile

The `getProfile` function retrieves detailed information about a user's profile, including their handle, display name, bio, and profile image.

#### Parameters

```ts twoslash
type GetProfileParams = {
  address: string;   // The user's wallet address
};
```

#### Usage Example

```ts twoslash
import { getProfile } from "@zoralabs/coins-sdk";

async function fetchUserProfile() {
  try {
    const response = await getProfile({
      address: "0xUserWalletAddress",
    });
    
    const profile = response.profile;
    
    if (profile) {
      console.log("Profile Details:");
      console.log("- Handle:", profile.handle);
      console.log("- Display Name:", profile.displayName);
      console.log("- Bio:", profile.bio);
      
      // Access profile image if available
      if (profile.profileImage?.previewImage) {
        console.log("- Profile Image:", profile.profileImage.previewImage);
      }
      
      // Access social links if available
      if (profile.socialLinks && profile.socialLinks.length > 0) {
        console.log("Social Links:");
        profile.socialLinks.forEach(link => {
          console.log(`- ${link.type}: ${link.url}`);
        });
      }
    } else {
      console.log("Profile not found or user has not set up a profile");
    }
    
    return response;
  } catch (error) {
    console.error("Error fetching user profile:", error);
    throw error;
  }
}
```

#### Response Structure

The response includes a `profile` object with the following properties:

```ts twoslash
{
  profile?: {
    address?: string;         // User's wallet address
    handle?: string;          // Username/handle
    displayName?: string;     // User's display name
    bio?: string;             // User's biography/description
    joinedAt?: string;        // When the user joined
    profileImage?: {          // Profile image data
      previewImage?: string;  // URL to profile image
      small?: string;         // Small version of profile image
      blurhash?: string;      // Blurhash for image loading
    };
    socialLinks?: Array<{     // Connected social accounts
      type?: string;          // Platform (e.g., "twitter", "instagram")
      url?: string;           // URL to social profile
    }>;
    followerCount?: number;   // Number of followers
    followingCount?: number;  // Number of accounts following
  }
}
```

### getProfileBalances

The `getProfileBalances` function retrieves a list of all coin balances held by a specific user, including the coin details and current value.

#### Parameters

```ts twoslash
type GetProfileBalancesParams = {
  address: string;    // The user's wallet address
  after?: string;     // Optional: Pagination cursor for fetching next page
  count?: number;     // Optional: Number of balances to return per page
};
```

#### Usage Example

```ts twoslash
import { getProfileBalances } from "@zoralabs/coins-sdk";

async function fetchUserBalances() {
  try {
    const response = await getProfileBalances({
      address: "0xUserWalletAddress",
      count: 20,        // Optional: number of balances per page
      after: undefined, // Optional: for pagination
    });
    
    console.log(`Found ${response.balances?.length || 0} coin balances`);
    
    response.balances?.forEach((balance, index) => {
      const coinName = balance.token?.name || "Unknown";
      const coinSymbol = balance.token?.symbol || "???";
      const amount = balance.amount?.amountDecimal || 0;
      const valueUsd = balance.valueUsd ? `$${parseFloat(balance.valueUsd).toFixed(2)}` : "N/A";
      
      console.log(`Balance ${index + 1}: ${amount} ${coinSymbol} (${coinName}) - Value: ${valueUsd}`);
      
      // Additional coin details if needed
      if (balance.token) {
        console.log(`  Coin Address: ${balance.token.address}`);
        console.log(`  Market Cap: ${balance.token.marketCap || "N/A"}`);
        console.log(`  24h Volume: ${balance.token.volume24h || "N/A"}`);
      }
    });
    
    // For pagination
    if (response.pagination?.cursor) {
      console.log("Next page cursor:", response.pagination.cursor);
    }
    
    return response;
  } catch (error) {
    console.error("Error fetching user balances:", error);
    throw error;
  }
}
```

#### Paginating Through All Balances

If a user holds many coins, you might need to paginate through all of their balances:

```ts twoslash
import { getProfileBalances } from "@zoralabs/coins-sdk";

async function fetchAllUserBalances(userAddress) {
  let allBalances = [];
  let cursor = undefined;
  const pageSize = 20;
  
  try {
    // Continue fetching until no more pages
    do {
      const response = await getProfileBalances({
        address: userAddress,
        count: pageSize,
        after: cursor,
      });
      
      // Add balances to our collection
      if (response.balances && response.balances.length > 0) {
        allBalances = [...allBalances, ...response.balances];
      }
      
      // Update cursor for next page
      cursor = response.pagination?.cursor;
      
      // Break if no more results
      if (!cursor || response.balances?.length === 0) {
        break;
      }
      
    } while (true);
    
    console.log(`Fetched ${allBalances.length} total coin balances`);
    return allBalances;
  } catch (error) {
    console.error("Error fetching all user balances:", error);
    throw error;
  }
}
```

#### Response Structure

The response includes a `balances` array and pagination information:

```ts twoslash
{
  balances?: Array<{
    id?: string;              // Unique identifier for this balance
    token?: {                 // Coin information
      id?: string;            // Coin ID
      name?: string;          // Coin name
      symbol?: string;        // Trading symbol
      address?: string;       // Coin contract address
      chainId?: number;       // Chain ID
      totalSupply?: string;   // Total supply of the coin
      marketCap?: string;     // Current market capitalization
      volume24h?: string;     // 24-hour trading volume
      createdAt?: string;     // Creation timestamp
      uniqueHolders?: number; // Number of unique holders
      media?: {               // Media associated with the coin
        previewImage?: string;
        medium?: string;
        blurhash?: string;
      };
    };
    amount?: {                // Balance amount
      amountRaw?: string;     // Raw amount (in base units)
      amountDecimal?: number; // Decimal representation
    };
    valueUsd?: string;        // Estimated USD value
    timestamp?: string;       // Last updated timestamp
  }>;
  pagination?: {
    cursor?: string;          // Cursor for the next page
  };
}
```